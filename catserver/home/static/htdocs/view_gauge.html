
{%load staticfiles %}

<div class="row">
	<div class="col-md-12">
		<div class="box">
			<div class="box-header">
				<i class="fa fa-bar-chart-o"></i>
				<h3 class="box-title">Sensor Monitoring</h3>
				<div class="box-tools pull-right">
					<button class="btn btn-box-tool" data-widget="collapse"><i class="fa fa-minus"></i></button>
					<button class="btn btn-box-tool" data-widget="remove"><i class="fa fa-times"></i></button>
				</div>
			</div>
			<!-- /.box-header -->
			<div class="box-body no-padding">
				<div class="row">
                <div class="col-xs-6 col-md-3 text-center">
                  <div id="gauge1" style="width:200px; height:150px"></div>
                </div>
                <div class="col-xs-6 col-md-3 text-center">
                  <div id="gauge2" style="width:200px; height:150px"></div>
                </div>
                <div class="col-xs-6 col-md-3 text-center">
                  <div id="gauge3" style="width:200px; height:150px"></div>
                </div>
                <div class="col-xs-6 col-md-3 text-center">
                  <div id="gauge4" style="width:200px; height:150px"></div>
                </div>
             </div>
			</div>
			<!-- /.box-body -->
		</div>
	<!-- /.box -->
	</div><!-- /.col -->
</div><!-- /.row -->

<script type="text/javascript">

$(document).ready(function(){
	
	var g1 = new JustGage({
		id: "gauge1", 
		value: 0, 
		min: -100,
		max: 100,
		title: 'Temperature #1',
		titleFontColor:"#0f0f0f",
		gaugeWidthScale:0.4,
		levelColorsGradient:true,
		refreshAnimationType:"linear",
		refreshAnimationTime:3,
		startAnimationType:"linear",
		startAnimationTime:3,
		labelFontColor:"#000000",
		gaugeColor:"#eeeeee",
		valueFontColor:"#000000",
		label: "Deg"
  	});
  var g2 = new JustGage({
		id: "gauge2", 
		value: 0, 
		min: -100,
		max: 100,
		title: 'Temperature #2',
		titleFontColor:"#0f0f0f",
		gaugeWidthScale:0.4,
		levelColorsGradient:true,
		refreshAnimationType:"linear",
		refreshAnimationTime:3,
		startAnimationType:"linear",
		startAnimationTime:3,
		labelFontColor:"#000000",
		gaugeColor:"#eeeeee",
		valueFontColor:"#000000",
		label: "Deg"
	});
  var g3 = new JustGage({
		id: "gauge3", 
		value: 0, 
		min: -100,
		max: 100,
		title: 'Temperature #3',
		titleFontColor:"#0f0f0f",
		gaugeWidthScale:0.4,
		levelColorsGradient:true,
		refreshAnimationType:"linear",
		refreshAnimationTime:3,
		startAnimationType:"linear",
		startAnimationTime:3,
		labelFontColor:"#000000",
		gaugeColor:"#eeeeee",
		valueFontColor:"#000000",
		label: "Deg"
	});
  var g4 = new JustGage({
		id: "gauge4", 
		value: 0, 
		min: -100,
		max: 100,
		title: 'Temperature #4',
		titleFontColor:"#0f0f0f",
		gaugeWidthScale:0.4,
		levelColorsGradient:true,
		refreshAnimationType:"linear",
		refreshAnimationTime:3,
		startAnimationType:"linear",
		startAnimationTime:3,
		labelFontColor:"#000000",
		gaugeColor:"#eeeeee",
		valueFontColor:"#000000",
		label: "Deg"
	});	
  
	var socket_uri = "ws://127.0.0.1:9002/sensor"
	var sock = new WebSocket(socket_uri)
	
	sock.onopen = function(){
		console.log("connection to " + socket_uri);
		$('#connection').html("<div class='callout callout-success' style='margin-bottom: 0!important;'><h4><i class='fa fa-info'></i> Success:</h4> Successfully connected to the server "+socket_uri+".</div></div>");
		
	}
	sock.onclose = function(e){
		console.log("connection closed(" + e.code + ")")
		$('#connection').html("<div class='callout callout-danger' style='margin-bottom: 0!important;'><h4><i class='fa fa-ban'></i> Fail:</h4>Alert!"+socket_uri+" connection is failed.</div></div>");
	}
	sock.onmessage = function(e){
		var jsondata = jQuery.parseJSON(e.data);
		
		if(jsondata.value>0){
			g1.refresh(jsondata.value);
		}
		
	}

});

</script>
